{
  "comparison_df": [
    {
      "Model": "LightGCN",
      "Recall@10": 1.0,
      "Recall@20": 1.0,
      "NDCG@10": 0.5896918237758785,
      "NDCG@20": 0.5896918237758785,
      "Precision@10": 0.24,
      "Precision@20": 0.24,
      "Training Time (s)": 0.10559201240539551,
      "Inference Time (ms)": 2.6303768157958984,
      "Coverage (%)": 0.6493506493506493,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.18245421137128556,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 5,
      "_num_article_types": 1
    },
    {
      "Model": "Content-Based",
      "Recall@10": 1.0,
      "Recall@20": 1.0,
      "NDCG@10": 0.2890648263178879,
      "NDCG@20": 0.2890648263178879,
      "Precision@10": 0.1,
      "Precision@20": 0.05,
      "Training Time (s)": 0.058481454849243164,
      "Inference Time (ms)": 3.875446319580078,
      "Coverage (%)": 5.0649350649350655,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.5064474187766222,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 39,
      "_num_article_types": 1
    },
    {
      "Model": "Hybrid",
      "Recall@10": 0.4,
      "Recall@20": 0.4,
      "NDCG@10": 0.25781296526357755,
      "NDCG@20": 0.25781296526357755,
      "Precision@10": 0.04,
      "Precision@20": 0.02,
      "Training Time (s)": 0.1645958423614502,
      "Inference Time (ms)": 3.3439159393310547,
      "Coverage (%)": 4.285714285714286,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.35776604827425934,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 33,
      "_num_article_types": 1
    }
  ],
  "weighted_scores": [
    {
      "Model": "Hybrid",
      "Weighted Score": 0.5861371622687199,
      "Accuracy Component": 0.13456259305271553,
      "Performance Component": 0.012343799985235132,
      "Coverage/Diversity Component": 0.08923076923076922
    },
    {
      "Model": "LightGCN",
      "Weighted Score": 0.44333575895348193,
      "Accuracy Component": 0.3539383647551757,
      "Performance Component": 0.050423035223947255,
      "Coverage/Diversity Component": 0.03897435897435897
    },
    {
      "Model": "Content-Based",
      "Weighted Score": 0.40399476402220535,
      "Accuracy Component": 0.2653129652635776,
      "Performance Component": 0.038681798758627685,
      "Coverage/Diversity Component": 0.1
    }
  ],
  "best_model": "Hybrid",
  "best_score": 0.5861371622687199,
  "issues": [],
  "model_algorithms": {
    "LightGCN": {
      "computation_steps": [
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [-0.08128084242343903, -0.11690421402454376, -0.07109326869249344]..., e_i[0] = [-0.1797647774219513, 0.06444522738456726, 0.08022930473089218]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [-0.08128084242343903, -0.11690421402454376, -0.07109326869249344]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 4.0 * (0.1438) = 0.5751\nr̂_neg = 0.1692",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.5751 - 0.1692 = 0.4058\nsigmoid(diff) = 0.6001\nLoss = 0.6997",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 20\nFinal loss = 0.6992",
          "meaning": "Model đã được train 20 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        },
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [0.09963534772396088, 0.06145069748163223, 0.005937333684414625]..., e_i[0] = [-0.060677628964185715, -0.027005700394511223, 0.0940384715795517]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [0.09963534772396088, 0.06145069748163223, 0.005937333684414625]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 3.0 * (0.1376) = 0.4128\nr̂_neg = 0.1271",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.4128 - 0.1271 = 0.2857\nsigmoid(diff) = 0.5709\nLoss = 0.6873",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 30\nFinal loss = 0.6994",
          "meaning": "Model đã được train 30 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        }
      ],
      "matrices": {
        "initial_user_embeddings": [
          [
            0.09963534772396088,
            0.06145069748163223,
            0.005937333684414625,
            -0.08907821774482727,
            0.2869645059108734,
            0.005220442544668913,
            0.035114552825689316,
            -0.10096025466918945,
            -0.011163364164531231,
            0.0827915295958519
          ]
        ],
        "initial_product_embeddings": [
          [
            -0.060677628964185715,
            -0.027005700394511223,
            0.0940384715795517,
            -0.04765096679329872,
            -0.12260681390762329,
            0.030716434121131897,
            -0.018185464665293694,
            0.013883610256016254,
            -0.07153346389532089,
            0.07414238899946213
          ],
          [
            -0.12759678065776825,
            -0.019467685371637344,
            0.0740610659122467,
            0.07167471945285797,
            0.013825207017362118,
            -0.02311701886355877,
            -0.017048431560397148,
            -0.17670270800590515,
            0.1024068221449852,
            0.00029741355683654547
          ],
          [
            0.20656132698059082,
            -0.02002735249698162,
            -0.05079624056816101,
            -0.08713538199663162,
            0.17095783352851868,
            -0.07797833532094955,
            -0.0012766756117343903,
            -0.017689308151602745,
            -0.09934089332818985,
            -0.02790701761841774
          ],
          [
            0.04877219721674919,
            0.09787237644195557,
            -0.004573707468807697,
            -0.02440188266336918,
            -0.10309558361768723,
            -0.05582037568092346,
            0.04983510449528694,
            0.02030857466161251,
            -0.21464471518993378,
            -0.158311128616333
          ]
        ],
        "final_user_embeddings": [
          [
            0.0646352618932724,
            0.05580931529402733,
            0.026036540046334267,
            -0.05641976743936539,
            0.13501688838005066,
            -0.0421818345785141,
            0.03691717982292175,
            -0.10234766453504562,
            -0.07865260541439056,
            -0.014287356287240982
          ]
        ],
        "final_product_embeddings": [
          [
            0.008372412994503975,
            0.013650097884237766,
            0.02660040743649006,
            -0.030236415565013885,
            0.03394940868020058,
            0.0007776549318805337,
            0.0073149362578988075,
            -0.03250768780708313,
            -0.034403908997774124,
            0.01839616894721985
          ],
          [
            -2.627633512020111e-05,
            0.02430901676416397,
            0.026788167655467987,
            -0.008542905561625957,
            0.076870396733284,
            -0.022572623565793037,
            0.016848722472786903,
            -0.08775497227907181,
            -0.0007690801285207272,
            0.00019081123173236847
          ],
          [
            0.07816063612699509,
            0.020485201850533485,
            -0.010421168990433216,
            -0.04200563579797745,
            0.11083195358514786,
            -0.03228286653757095,
            0.01674487069249153,
            -0.044129274785518646,
            -0.0442938394844532,
            -0.007351900450885296
          ],
          [
            0.042763758450746536,
            0.05317431688308716,
            0.009105672128498554,
            -0.03205457702279091,
            0.04838202893733978,
            -0.03028583712875843,
            0.03292582929134369,
            -0.04030337929725647,
            -0.07783836871385574,
            -0.03980979323387146
          ]
        ],
        "similarity_matrix": [
          [
            0.11964099109172821,
            0.18285542726516724,
            0.1535455286502838,
            0.21026574075222015
          ]
        ]
      }
    },
    "Content-Based": {
      "computation_steps": [
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.16666666666666666), '10065': np.float64(0.5), '10859': np.float64(0.3333333333333333)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.1875\n  ||u|| = 0.2297\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1875 / (0.2297 * 1.0000) = 0.8161",
          "meaning": "Similarity = 0.8161 nghĩa là sản phẩm này giống 81.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.8161\n  Product 479: similarity = 0.6684\n  Product 410: similarity = 0.6207\n  Product 2: similarity = 0.6198\n  Product 70: similarity = 0.6096",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.14285714285714285), '10859': np.float64(0.2857142857142857), '10866': np.float64(0.5714285714285714)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2220\n  ||u|| = 0.2481\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2220 / (0.2481 * 1.0000) = 0.8948",
          "meaning": "Similarity = 0.8948 nghĩa là sản phẩm này giống 89.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8948\n  Product 731: similarity = 0.6580\n  Product 418: similarity = 0.5922\n  Product 2: similarity = 0.5830\n  Product 300: similarity = 0.5642",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.125), '10065': np.float64(0.375), '10866': np.float64(0.5)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.3333333333333333), '10859': np.float64(0.2222222222222222), '10866': np.float64(0.4444444444444444)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1787\n  ||u|| = 0.2253\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1787 / (0.2253 * 1.0000) = 0.7931",
          "meaning": "Similarity = 0.7931 nghĩa là sản phẩm này giống 79.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7931\n  Product 418: similarity = 0.7246\n  Product 731: similarity = 0.6287\n  Product 1: similarity = 0.6218\n  Product 718: similarity = 0.6138",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10861': np.float64(0.1), '10065': np.float64(0.3), '10859': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1268\n  ||u|| = 0.1614\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1268 / (0.1614 * 1.0000) = 0.7858",
          "meaning": "Similarity = 0.7858 nghĩa là sản phẩm này giống 78.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7858\n  Product 418: similarity = 0.7187\n  Product 731: similarity = 0.6346\n  Product 1: similarity = 0.6076\n  Product 718: similarity = 0.5993",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.16666666666666666), '10065': np.float64(0.5), '10859': np.float64(0.3333333333333333)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.1875\n  ||u|| = 0.2297\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1875 / (0.2297 * 1.0000) = 0.8161",
          "meaning": "Similarity = 0.8161 nghĩa là sản phẩm này giống 81.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.8161\n  Product 479: similarity = 0.6684\n  Product 410: similarity = 0.6207\n  Product 2: similarity = 0.6198\n  Product 70: similarity = 0.6096",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.14285714285714285), '10859': np.float64(0.2857142857142857), '10866': np.float64(0.5714285714285714)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2220\n  ||u|| = 0.2481\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2220 / (0.2481 * 1.0000) = 0.8948",
          "meaning": "Similarity = 0.8948 nghĩa là sản phẩm này giống 89.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8948\n  Product 731: similarity = 0.6580\n  Product 418: similarity = 0.5922\n  Product 2: similarity = 0.5830\n  Product 300: similarity = 0.5642",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.125), '10065': np.float64(0.375), '10866': np.float64(0.5)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.3333333333333333), '10859': np.float64(0.2222222222222222), '10866': np.float64(0.4444444444444444)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1787\n  ||u|| = 0.2253\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1787 / (0.2253 * 1.0000) = 0.7931",
          "meaning": "Similarity = 0.7931 nghĩa là sản phẩm này giống 79.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7931\n  Product 418: similarity = 0.7246\n  Product 731: similarity = 0.6287\n  Product 1: similarity = 0.6218\n  Product 718: similarity = 0.6138",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10861': np.float64(0.1), '10065': np.float64(0.3), '10859': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1268\n  ||u|| = 0.1614\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1268 / (0.1614 * 1.0000) = 0.7858",
          "meaning": "Similarity = 0.7858 nghĩa là sản phẩm này giống 78.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7858\n  Product 418: similarity = 0.7187\n  Product 731: similarity = 0.6346\n  Product 1: similarity = 0.6076\n  Product 718: similarity = 0.5993",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        }
      ],
      "matrices": {
        "tfidf_matrix": [
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12684788648202416,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10945684237870694,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10802273937743177,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.08762412121414109,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.3644387614539732,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0958778920615082,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.1306801178899534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.13046124571726606,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09261237733220674,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.18868384457697002,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.11477308257117103,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12441395746742534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09009132789563327,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09518415053626149,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.14393528245910975,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10739022769762342,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        ],
        "similarity_matrix": [
          [
            0.7857865084164
          ],
          [
            0.7187315680321897
          ],
          [
            0.6345768929473945
          ],
          [
            0.6075738985084314
          ],
          [
            0.5992678309621375
          ],
          [
            0.5341168652838784
          ],
          [
            0.5331758834138035
          ],
          [
            0.5247306639028462
          ],
          [
            0.5177645687793414
          ],
          [
            0.5129555653190923
          ],
          [
            0.49793216554179626
          ],
          [
            0.49793216554179626
          ],
          [
            0.49366241415232726
          ],
          [
            0.4922865137672058
          ],
          [
            0.48696050188931345
          ],
          [
            0.48664144232497797
          ],
          [
            0.48664144232497797
          ],
          [
            0.48664144232497797
          ],
          [
            0.4826230677147334
          ],
          [
            0.48244353696687564
          ]
        ]
      }
    },
    "Hybrid": {
      "alpha": 0.5,
      "lightgcn_steps": [
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [-0.08128084242343903, -0.11690421402454376, -0.07109326869249344]..., e_i[0] = [-0.1797647774219513, 0.06444522738456726, 0.08022930473089218]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [-0.08128084242343903, -0.11690421402454376, -0.07109326869249344]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 4.0 * (0.1438) = 0.5751\nr̂_neg = 0.1692",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.5751 - 0.1692 = 0.4058\nsigmoid(diff) = 0.6001\nLoss = 0.6997",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 20\nFinal loss = 0.6992",
          "meaning": "Model đã được train 20 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        },
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [0.09963534772396088, 0.06145069748163223, 0.005937333684414625]..., e_i[0] = [-0.060677628964185715, -0.027005700394511223, 0.0940384715795517]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [0.09963534772396088, 0.06145069748163223, 0.005937333684414625]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 3.0 * (0.1376) = 0.4128\nr̂_neg = 0.1271",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.4128 - 0.1271 = 0.2857\nsigmoid(diff) = 0.5709\nLoss = 0.6873",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 30\nFinal loss = 0.6994",
          "meaning": "Model đã được train 30 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        }
      ],
      "lightgcn_matrices": {
        "initial_user_embeddings": [
          [
            0.09963534772396088,
            0.06145069748163223,
            0.005937333684414625,
            -0.08907821774482727,
            0.2869645059108734,
            0.005220442544668913,
            0.035114552825689316,
            -0.10096025466918945,
            -0.011163364164531231,
            0.0827915295958519
          ]
        ],
        "initial_product_embeddings": [
          [
            -0.060677628964185715,
            -0.027005700394511223,
            0.0940384715795517,
            -0.04765096679329872,
            -0.12260681390762329,
            0.030716434121131897,
            -0.018185464665293694,
            0.013883610256016254,
            -0.07153346389532089,
            0.07414238899946213
          ],
          [
            -0.12759678065776825,
            -0.019467685371637344,
            0.0740610659122467,
            0.07167471945285797,
            0.013825207017362118,
            -0.02311701886355877,
            -0.017048431560397148,
            -0.17670270800590515,
            0.1024068221449852,
            0.00029741355683654547
          ],
          [
            0.20656132698059082,
            -0.02002735249698162,
            -0.05079624056816101,
            -0.08713538199663162,
            0.17095783352851868,
            -0.07797833532094955,
            -0.0012766756117343903,
            -0.017689308151602745,
            -0.09934089332818985,
            -0.02790701761841774
          ],
          [
            0.04877219721674919,
            0.09787237644195557,
            -0.004573707468807697,
            -0.02440188266336918,
            -0.10309558361768723,
            -0.05582037568092346,
            0.04983510449528694,
            0.02030857466161251,
            -0.21464471518993378,
            -0.158311128616333
          ]
        ],
        "final_user_embeddings": [
          [
            0.0646352618932724,
            0.05580931529402733,
            0.026036540046334267,
            -0.05641976743936539,
            0.13501688838005066,
            -0.0421818345785141,
            0.03691717982292175,
            -0.10234766453504562,
            -0.07865260541439056,
            -0.014287356287240982
          ]
        ],
        "final_product_embeddings": [
          [
            0.008372412994503975,
            0.013650097884237766,
            0.02660040743649006,
            -0.030236415565013885,
            0.03394940868020058,
            0.0007776549318805337,
            0.0073149362578988075,
            -0.03250768780708313,
            -0.034403908997774124,
            0.01839616894721985
          ],
          [
            -2.627633512020111e-05,
            0.02430901676416397,
            0.026788167655467987,
            -0.008542905561625957,
            0.076870396733284,
            -0.022572623565793037,
            0.016848722472786903,
            -0.08775497227907181,
            -0.0007690801285207272,
            0.00019081123173236847
          ],
          [
            0.07816063612699509,
            0.020485201850533485,
            -0.010421168990433216,
            -0.04200563579797745,
            0.11083195358514786,
            -0.03228286653757095,
            0.01674487069249153,
            -0.044129274785518646,
            -0.0442938394844532,
            -0.007351900450885296
          ],
          [
            0.042763758450746536,
            0.05317431688308716,
            0.009105672128498554,
            -0.03205457702279091,
            0.04838202893733978,
            -0.03028583712875843,
            0.03292582929134369,
            -0.04030337929725647,
            -0.07783836871385574,
            -0.03980979323387146
          ]
        ],
        "similarity_matrix": [
          [
            0.11964099109172821,
            0.18285542726516724,
            0.1535455286502838,
            0.21026574075222015
          ]
        ]
      },
      "cbf_steps": [
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.16666666666666666), '10065': np.float64(0.5), '10859': np.float64(0.3333333333333333)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.1875\n  ||u|| = 0.2297\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1875 / (0.2297 * 1.0000) = 0.8161",
          "meaning": "Similarity = 0.8161 nghĩa là sản phẩm này giống 81.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.8161\n  Product 479: similarity = 0.6684\n  Product 410: similarity = 0.6207\n  Product 2: similarity = 0.6198\n  Product 70: similarity = 0.6096",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.14285714285714285), '10859': np.float64(0.2857142857142857), '10866': np.float64(0.5714285714285714)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2220\n  ||u|| = 0.2481\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2220 / (0.2481 * 1.0000) = 0.8948",
          "meaning": "Similarity = 0.8948 nghĩa là sản phẩm này giống 89.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8948\n  Product 731: similarity = 0.6580\n  Product 418: similarity = 0.5922\n  Product 2: similarity = 0.5830\n  Product 300: similarity = 0.5642",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.125), '10065': np.float64(0.375), '10866': np.float64(0.5)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.3333333333333333), '10859': np.float64(0.2222222222222222), '10866': np.float64(0.4444444444444444)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1787\n  ||u|| = 0.2253\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1787 / (0.2253 * 1.0000) = 0.7931",
          "meaning": "Similarity = 0.7931 nghĩa là sản phẩm này giống 79.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7931\n  Product 418: similarity = 0.7246\n  Product 731: similarity = 0.6287\n  Product 1: similarity = 0.6218\n  Product 718: similarity = 0.6138",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10861': np.float64(0.1), '10065': np.float64(0.3), '10859': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1268\n  ||u|| = 0.1614\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1268 / (0.1614 * 1.0000) = 0.7858",
          "meaning": "Similarity = 0.7858 nghĩa là sản phẩm này giống 78.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7858\n  Product 418: similarity = 0.7187\n  Product 731: similarity = 0.6346\n  Product 1: similarity = 0.6076\n  Product 718: similarity = 0.5993",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.16666666666666666), '10065': np.float64(0.5), '10859': np.float64(0.3333333333333333)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.1875\n  ||u|| = 0.2297\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1875 / (0.2297 * 1.0000) = 0.8161",
          "meaning": "Similarity = 0.8161 nghĩa là sản phẩm này giống 81.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.8161\n  Product 479: similarity = 0.6684\n  Product 410: similarity = 0.6207\n  Product 2: similarity = 0.6198\n  Product 70: similarity = 0.6096",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.14285714285714285), '10859': np.float64(0.2857142857142857), '10866': np.float64(0.5714285714285714)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2220\n  ||u|| = 0.2481\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2220 / (0.2481 * 1.0000) = 0.8948",
          "meaning": "Similarity = 0.8948 nghĩa là sản phẩm này giống 89.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8948\n  Product 731: similarity = 0.6580\n  Product 418: similarity = 0.5922\n  Product 2: similarity = 0.5830\n  Product 300: similarity = 0.5642",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10861': np.float64(0.125), '10065': np.float64(0.375), '10866': np.float64(0.5)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.3333333333333333), '10859': np.float64(0.2222222222222222), '10866': np.float64(0.4444444444444444)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1787\n  ||u|| = 0.2253\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1787 / (0.2253 * 1.0000) = 0.7931",
          "meaning": "Similarity = 0.7931 nghĩa là sản phẩm này giống 79.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7931\n  Product 418: similarity = 0.7246\n  Product 731: similarity = 0.6287\n  Product 1: similarity = 0.6218\n  Product 718: similarity = 0.6138",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10861': np.float64(0.1), '10065': np.float64(0.3), '10859': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1268\n  ||u|| = 0.1614\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1268 / (0.1614 * 1.0000) = 0.7858",
          "meaning": "Similarity = 0.7858 nghĩa là sản phẩm này giống 78.6% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.7858\n  Product 418: similarity = 0.7187\n  Product 731: similarity = 0.6346\n  Product 1: similarity = 0.6076\n  Product 718: similarity = 0.5993",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        }
      ],
      "cbf_matrices": {
        "tfidf_matrix": [
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12684788648202416,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10945684237870694,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10802273937743177,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.08762412121414109,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.3644387614539732,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0958778920615082,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.1306801178899534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.13046124571726606,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09261237733220674,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.18868384457697002,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.11477308257117103,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12441395746742534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09009132789563327,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09518415053626149,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.14393528245910975,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10739022769762342,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        ],
        "similarity_matrix": [
          [
            0.7857865084164
          ],
          [
            0.7187315680321897
          ],
          [
            0.6345768929473945
          ],
          [
            0.6075738985084314
          ],
          [
            0.5992678309621375
          ],
          [
            0.5341168652838784
          ],
          [
            0.5331758834138035
          ],
          [
            0.5247306639028462
          ],
          [
            0.5177645687793414
          ],
          [
            0.5129555653190923
          ],
          [
            0.49793216554179626
          ],
          [
            0.49793216554179626
          ],
          [
            0.49366241415232726
          ],
          [
            0.4922865137672058
          ],
          [
            0.48696050188931345
          ],
          [
            0.48664144232497797
          ],
          [
            0.48664144232497797
          ],
          [
            0.48664144232497797
          ],
          [
            0.4826230677147334
          ],
          [
            0.48244353696687564
          ]
        ]
      }
    }
  },
  "train_stats": {
    "train_size": 4,
    "test_size": 1,
    "train_ratio": 0.8,
    "train_users": 1,
    "test_users": 1,
    "train_products": 4,
    "test_products": 1
  },
  "test_pairs": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10866",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10065",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10859",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10861",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10439",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    }
  ],
  "sample_train_data": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10861",
      "interaction_type": "view"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10065",
      "interaction_type": "cart"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10859",
      "interaction_type": "like"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10866",
      "interaction_type": "purchase"
    }
  ],
  "sample_test_data": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10439",
      "interaction_type": "view"
    }
  ]
}