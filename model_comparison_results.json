{
  "comparison_df": [
    {
      "Model": "LightGCN",
      "Recall@10": 1.0,
      "Recall@20": 1.0,
      "NDCG@10": 0.5896918237758785,
      "NDCG@20": 0.5896918237758785,
      "Precision@10": 0.24,
      "Precision@20": 0.24,
      "Training Time (s)": 0.11152458190917969,
      "Inference Time (ms)": 0.6723880767822266,
      "Coverage (%)": 0.6493506493506493,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.20446051586241948,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 5,
      "_num_article_types": 1
    },
    {
      "Model": "Content-Based",
      "Recall@10": 1.0,
      "Recall@20": 1.0,
      "NDCG@10": 0.2890648263178879,
      "NDCG@20": 0.2890648263178879,
      "Precision@10": 0.1,
      "Precision@20": 0.05,
      "Training Time (s)": 0.06487488746643066,
      "Inference Time (ms)": 3.977441787719726,
      "Coverage (%)": 5.584415584415584,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.5167646081248387,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 43,
      "_num_article_types": 1
    },
    {
      "Model": "Hybrid",
      "Recall@10": 0.4,
      "Recall@20": 0.4,
      "NDCG@10": 0.26309297535714576,
      "NDCG@20": 0.26309297535714576,
      "Precision@10": 0.04,
      "Precision@20": 0.02,
      "Training Time (s)": 0.17708659172058105,
      "Inference Time (ms)": 3.6812782287597656,
      "Coverage (%)": 5.194805194805195,
      "Diversity (ArticleTypes)": 1,
      "Avg Score": 0.35878018522155974,
      "_num_pairs_evaluated": 5,
      "_num_recommendations": 40,
      "_num_article_types": 1
    }
  ],
  "weighted_scores": [
    {
      "Model": "Hybrid",
      "Weighted Score": 0.5874363475326344,
      "Accuracy Component": 0.13561859507142918,
      "Performance Component": 0.006701473391437774,
      "Coverage/Diversity Component": 0.09511627906976744
    },
    {
      "Model": "LightGCN",
      "Weighted Score": 0.4890769075579422,
      "Accuracy Component": 0.3539383647551757,
      "Performance Component": 0.09699900791904553,
      "Coverage/Diversity Component": 0.03813953488372093
    },
    {
      "Model": "Content-Based",
      "Weighted Score": 0.40333223137420626,
      "Accuracy Component": 0.2653129652635776,
      "Performance Component": 0.03801926611062867,
      "Coverage/Diversity Component": 0.1
    }
  ],
  "best_model": "Hybrid",
  "best_score": 0.5874363475326344,
  "issues": [],
  "model_algorithms": {
    "LightGCN": {
      "computation_steps": [
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [0.12077154219150543, -0.014385554008185863, -0.06516893953084946]..., e_i[0] = [0.08779389411211014, 0.05576595664024353, -0.03229561820626259]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [0.12077154219150543, -0.014385554008185863, -0.06516893953084946]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 4.0 * (0.1230) = 0.4920\nr̂_neg = 0.1286",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.4920 - 0.1286 = 0.3634\nsigmoid(diff) = 0.5899\nLoss = 0.6943",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 20\nFinal loss = 0.6811",
          "meaning": "Model đã được train 20 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        },
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [-0.18846020102500916, -0.20239797234535217, 0.16714732348918915]..., e_i[0] = [0.11666425317525864, -0.0892360508441925, 0.02530834451317787]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [-0.18846020102500916, -0.20239797234535217, 0.16714732348918915]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 1.0 * (0.1598) = 0.1598\nr̂_neg = 0.1708",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.1598 - 0.1708 = -0.0110\nsigmoid(diff) = 0.4972\nLoss = 0.6993",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 30\nFinal loss = 0.6880",
          "meaning": "Model đã được train 30 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        }
      ],
      "matrices": {
        "initial_user_embeddings": [
          [
            -0.18846020102500916,
            -0.20239797234535217,
            0.16714732348918915,
            0.07743873447179794,
            0.02012442983686924,
            0.06533992290496826,
            -0.057898182421922684,
            -0.07597088068723679,
            0.08732300251722336,
            -0.038137760013341904
          ]
        ],
        "initial_product_embeddings": [
          [
            0.11666425317525864,
            -0.0892360508441925,
            0.02530834451317787,
            -0.011922111734747887,
            -0.04505776986479759,
            0.043116822838783264,
            0.04712482914328575,
            -0.06896278262138367,
            0.054997533559799194,
            -0.06692278385162354
          ],
          [
            0.03521358594298363,
            -0.1653403639793396,
            -0.0940631851553917,
            -0.06493079662322998,
            0.1539645791053772,
            0.17329342663288116,
            -0.012535897083580494,
            0.06311952322721481,
            0.06552440673112869,
            -0.0004453062720131129
          ],
          [
            0.01749483309686184,
            -0.03763618320226669,
            0.09417550265789032,
            0.00475421454757452,
            -0.06732126325368881,
            0.024889560416340828,
            0.03457285091280937,
            -0.12439723312854767,
            0.012319310568273067,
            -0.11214294284582138
          ],
          [
            -0.029835766181349754,
            -0.07644005864858627,
            0.053750306367874146,
            0.026440728455781937,
            -0.0004305418988224119,
            0.046273041516542435,
            0.01179537083953619,
            -0.03430710732936859,
            0.05432720109820366,
            0.03441586345434189
          ]
        ],
        "final_user_embeddings": [
          [
            -0.04843805730342865,
            -0.21061763167381287,
            0.08682338148355484,
            0.0017104875296354294,
            0.05367157980799675,
            0.12421853840351105,
            -0.03106197714805603,
            -0.06124407798051834,
            0.10552720725536346,
            -0.05131629481911659
          ]
        ],
        "final_product_embeddings": [
          [
            -0.005493465811014175,
            -0.10763142257928848,
            0.04593004286289215,
            0.0007880381308495998,
            0.014381087385118008,
            0.05809766799211502,
            -0.012427550740540028,
            -0.03865790367126465,
            0.05778437480330467,
            -0.03563683480024338
          ],
          [
            -0.029692374169826508,
            -0.12894408404827118,
            0.021563103422522545,
            -0.00948348082602024,
            0.06405331194400787,
            0.09215563535690308,
            -0.027441348880529404,
            -0.010732058435678482,
            0.06301595270633698,
            -0.02198859676718712
          ],
          [
            -0.024244438856840134,
            -0.08710083365440369,
            0.05772198736667633,
            0.002470834646373987,
            0.0063803778029978275,
            0.046178679913282394,
            -0.007965127006173134,
            -0.047968100756406784,
            0.03930751234292984,
            -0.04204539209604263
          ],
          [
            -0.03744583576917648,
            -0.09755893051624298,
            0.0484316311776638,
            0.009645583108067513,
            0.022528376430273056,
            0.052005089819431305,
            -0.01428992860019207,
            -0.02513008750975132,
            0.05094657093286514,
            -0.0029617687687277794
          ]
        ],
        "similarity_matrix": [
          [
            0.20353266596794128,
            0.22132623195648193,
            0.17801246047019958,
            0.15586280822753906
          ]
        ]
      }
    },
    "Content-Based": {
      "computation_steps": [
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.6), '10861': np.float64(0.2), '10439': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.2221\n  ||u|| = 0.2434\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2221 / (0.2434 * 1.0000) = 0.9127",
          "meaning": "Similarity = 0.9127 nghĩa là sản phẩm này giống 91.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.9127\n  Product 479: similarity = 0.7453\n  Product 70: similarity = 0.6781\n  Product 278: similarity = 0.6710\n  Product 401: similarity = 0.6710",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10866': np.float64(0.6666666666666666), '10861': np.float64(0.16666666666666666), '10439': np.float64(0.16666666666666666)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2452\n  ||u|| = 0.2584\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2452 / (0.2584 * 1.0000) = 0.9486",
          "meaning": "Similarity = 0.9486 nghĩa là sản phẩm này giống 94.9% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.9486\n  Product 731: similarity = 0.6970\n  Product 341: similarity = 0.6220\n  Product 418: similarity = 0.6131\n  Product 473: similarity = 0.5909",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10065': np.float64(0.3333333333333333), '10866': np.float64(0.4444444444444444), '10861': np.float64(0.1111111111111111)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1340\n  ||u|| = 0.1665\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1340 / (0.1665 * 1.0000) = 0.8049",
          "meaning": "Similarity = 0.8049 nghĩa là sản phẩm này giống 80.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8049\n  Product 418: similarity = 0.7353\n  Product 731: similarity = 0.6525\n  Product 1: similarity = 0.6474\n  Product 718: similarity = 0.6387",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10439': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1906\n  ||u|| = 0.2347\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1906 / (0.2347 * 1.0000) = 0.8120",
          "meaning": "Similarity = 0.8120 nghĩa là sản phẩm này giống 81.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8120\n  Product 418: similarity = 0.7408\n  Product 1: similarity = 0.6636\n  Product 718: similarity = 0.6554\n  Product 731: similarity = 0.6456",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10861': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.6), '10861': np.float64(0.2), '10439': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.2221\n  ||u|| = 0.2434\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2221 / (0.2434 * 1.0000) = 0.9127",
          "meaning": "Similarity = 0.9127 nghĩa là sản phẩm này giống 91.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.9127\n  Product 479: similarity = 0.7453\n  Product 70: similarity = 0.6781\n  Product 278: similarity = 0.6710\n  Product 401: similarity = 0.6710",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10866': np.float64(0.6666666666666666), '10861': np.float64(0.16666666666666666), '10439': np.float64(0.16666666666666666)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2452\n  ||u|| = 0.2584\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2452 / (0.2584 * 1.0000) = 0.9486",
          "meaning": "Similarity = 0.9486 nghĩa là sản phẩm này giống 94.9% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.9486\n  Product 731: similarity = 0.6970\n  Product 341: similarity = 0.6220\n  Product 418: similarity = 0.6131\n  Product 473: similarity = 0.5909",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10065': np.float64(0.3333333333333333), '10866': np.float64(0.4444444444444444), '10861': np.float64(0.1111111111111111)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1340\n  ||u|| = 0.1665\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1340 / (0.1665 * 1.0000) = 0.8049",
          "meaning": "Similarity = 0.8049 nghĩa là sản phẩm này giống 80.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8049\n  Product 418: similarity = 0.7353\n  Product 731: similarity = 0.6525\n  Product 1: similarity = 0.6474\n  Product 718: similarity = 0.6387",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10439': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1906\n  ||u|| = 0.2347\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1906 / (0.2347 * 1.0000) = 0.8120",
          "meaning": "Similarity = 0.8120 nghĩa là sản phẩm này giống 81.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8120\n  Product 418: similarity = 0.7408\n  Product 1: similarity = 0.6636\n  Product 718: similarity = 0.6554\n  Product 731: similarity = 0.6456",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10861': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        }
      ],
      "matrices": {
        "tfidf_matrix": [
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12684788648202416,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10945684237870694,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10802273937743177,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.08762412121414109,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.3644387614539732,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0958778920615082,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.1306801178899534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.13046124571726606,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09261237733220674,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.18868384457697002,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.11477308257117103,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12441395746742534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09009132789563327,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09518415053626149,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.14393528245910975,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10739022769762342,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        ],
        "similarity_matrix": [
          [
            0.8221978470290819
          ],
          [
            0.7504883952006588
          ],
          [
            0.6508351729770462
          ],
          [
            0.6430406271956725
          ],
          [
            0.6429416273851217
          ],
          [
            0.5523535767199524
          ],
          [
            0.5430679569431078
          ],
          [
            0.5421089664618155
          ],
          [
            0.518318911740092
          ],
          [
            0.5135647424129608
          ],
          [
            0.5030875097547388
          ],
          [
            0.495788797018222
          ],
          [
            0.4922891994579217
          ],
          [
            0.49086363523980237
          ],
          [
            0.4853831692148929
          ],
          [
            0.4853831692148929
          ],
          [
            0.4845968744403366
          ],
          [
            0.48242265575179
          ],
          [
            0.47722103133678545
          ],
          [
            0.4756673962297847
          ]
        ]
      }
    },
    "Hybrid": {
      "alpha": 0.5,
      "lightgcn_steps": [
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [0.12077154219150543, -0.014385554008185863, -0.06516893953084946]..., e_i[0] = [0.08779389411211014, 0.05576595664024353, -0.03229561820626259]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [0.12077154219150543, -0.014385554008185863, -0.06516893953084946]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 4.0 * (0.1230) = 0.4920\nr̂_neg = 0.1286",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.4920 - 0.1286 = 0.3634\nsigmoid(diff) = 0.5899\nLoss = 0.6943",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 20\nFinal loss = 0.6811",
          "meaning": "Model đã được train 20 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        },
        {
          "step": "Bước 1: Xây dựng đồ thị",
          "formula": "G = (U ∪ I, E)",
          "computation": "Số users: 1, Số products: 4, Số edges: 4",
          "meaning": "Đồ thị có 1 nodes user và 4 nodes product, tạo thành 4 cạnh tương tác"
        },
        {
          "step": "Bước 2: Khởi tạo Embeddings",
          "formula": "e_u^(0) ~ N(0, 0.1²), e_i^(0) ~ N(0, 0.1²)",
          "computation": "User embeddings shape: torch.Size([1, 64]), Product embeddings shape: torch.Size([4, 64])\nVí dụ e_u[0] = [-0.18846020102500916, -0.20239797234535217, 0.16714732348918915]..., e_i[0] = [0.11666425317525864, -0.0892360508441925, 0.02530834451317787]...",
          "meaning": "Mỗi user và product được biểu diễn bằng vector 64 chiều, khởi tạo ngẫu nhiên từ phân phối chuẩn"
        },
        {
          "step": "Bước 3: LightGCN Propagation",
          "formula": "e_u^(l+1) = Σ (e_i^(l) / √(deg(u) * deg(i)))",
          "computation": "Ví dụ với user 0:\n  deg(user_0) = 4 (số edges từ user này)\n  e_user_0^(0) = [-0.18846020102500916, -0.20239797234535217, 0.16714732348918915]...\n  Sau propagation qua 3 layers, embedding được cập nhật",
          "meaning": "Embedding của user được cập nhật bằng cách tổng hợp thông tin từ các products mà user đã tương tác, với normalization theo bậc của node"
        },
        {
          "step": "Bước 4: Average Embeddings từ tất cả layers",
          "formula": "e_u = (1/(L+1)) * Σ e_u^(l)",
          "computation": "L = 3 layers\nTổng hợp embeddings từ layer 0 đến layer 3\ne_u_final = (e_u^(0) + e_u^(1) + ... + e_u^(3)) / 4",
          "meaning": "Final embedding là trung bình của embeddings từ tất cả 4 layers (bao gồm initial), giúp giữ lại thông tin từ mọi độ sâu của graph"
        },
        {
          "step": "Bước 5: Dự đoán Rating (với interaction weights)",
          "formula": "r̂_ui = w_type * (e_u^T · e_i)",
          "computation": "Ví dụ: r̂_pos = 1.0 * (0.1598) = 0.1598\nr̂_neg = 0.1708",
          "meaning": "Score được nhân với weight theo interaction type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 6: BPR Loss",
          "formula": "L_BPR = -Σ log(σ(w_type * (r̂_ui - r̂_uj)))",
          "computation": "Ví dụ: diff = 0.1598 - 0.1708 = -0.0110\nsigmoid(diff) = 0.4972\nLoss = 0.6993",
          "meaning": "Loss càng nhỏ càng tốt, nghĩa là model phân biệt tốt giữa positive và negative pairs"
        },
        {
          "step": "Bước 7: Gradient Descent",
          "formula": "θ ← θ - α * ∇L_BPR",
          "computation": "Learning rate α = 0.001, Số epochs = 30\nFinal loss = 0.6880",
          "meaning": "Model đã được train 30 epochs, embeddings đã được cập nhật để tối ưu BPR loss"
        }
      ],
      "lightgcn_matrices": {
        "initial_user_embeddings": [
          [
            -0.18846020102500916,
            -0.20239797234535217,
            0.16714732348918915,
            0.07743873447179794,
            0.02012442983686924,
            0.06533992290496826,
            -0.057898182421922684,
            -0.07597088068723679,
            0.08732300251722336,
            -0.038137760013341904
          ]
        ],
        "initial_product_embeddings": [
          [
            0.11666425317525864,
            -0.0892360508441925,
            0.02530834451317787,
            -0.011922111734747887,
            -0.04505776986479759,
            0.043116822838783264,
            0.04712482914328575,
            -0.06896278262138367,
            0.054997533559799194,
            -0.06692278385162354
          ],
          [
            0.03521358594298363,
            -0.1653403639793396,
            -0.0940631851553917,
            -0.06493079662322998,
            0.1539645791053772,
            0.17329342663288116,
            -0.012535897083580494,
            0.06311952322721481,
            0.06552440673112869,
            -0.0004453062720131129
          ],
          [
            0.01749483309686184,
            -0.03763618320226669,
            0.09417550265789032,
            0.00475421454757452,
            -0.06732126325368881,
            0.024889560416340828,
            0.03457285091280937,
            -0.12439723312854767,
            0.012319310568273067,
            -0.11214294284582138
          ],
          [
            -0.029835766181349754,
            -0.07644005864858627,
            0.053750306367874146,
            0.026440728455781937,
            -0.0004305418988224119,
            0.046273041516542435,
            0.01179537083953619,
            -0.03430710732936859,
            0.05432720109820366,
            0.03441586345434189
          ]
        ],
        "final_user_embeddings": [
          [
            -0.04843805730342865,
            -0.21061763167381287,
            0.08682338148355484,
            0.0017104875296354294,
            0.05367157980799675,
            0.12421853840351105,
            -0.03106197714805603,
            -0.06124407798051834,
            0.10552720725536346,
            -0.05131629481911659
          ]
        ],
        "final_product_embeddings": [
          [
            -0.005493465811014175,
            -0.10763142257928848,
            0.04593004286289215,
            0.0007880381308495998,
            0.014381087385118008,
            0.05809766799211502,
            -0.012427550740540028,
            -0.03865790367126465,
            0.05778437480330467,
            -0.03563683480024338
          ],
          [
            -0.029692374169826508,
            -0.12894408404827118,
            0.021563103422522545,
            -0.00948348082602024,
            0.06405331194400787,
            0.09215563535690308,
            -0.027441348880529404,
            -0.010732058435678482,
            0.06301595270633698,
            -0.02198859676718712
          ],
          [
            -0.024244438856840134,
            -0.08710083365440369,
            0.05772198736667633,
            0.002470834646373987,
            0.0063803778029978275,
            0.046178679913282394,
            -0.007965127006173134,
            -0.047968100756406784,
            0.03930751234292984,
            -0.04204539209604263
          ],
          [
            -0.03744583576917648,
            -0.09755893051624298,
            0.0484316311776638,
            0.009645583108067513,
            0.022528376430273056,
            0.052005089819431305,
            -0.01428992860019207,
            -0.02513008750975132,
            0.05094657093286514,
            -0.0029617687687277794
          ]
        ],
        "similarity_matrix": [
          [
            0.20353266596794128,
            0.22132623195648193,
            0.17801246047019958,
            0.15586280822753906
          ]
        ]
      },
      "cbf_steps": [
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 1: Tạo Feature Vector cho mỗi sản phẩm",
          "formula": "v_i = TF-IDF(gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName)",
          "computation": "Ví dụ sản phẩm 1: \"Men Apparel Topwear Tshirts Red Casual Wrangler Me...\"\nCác từ khóa: Men, Apparel, Topwear, Tshirts, Red...\nTổng số sản phẩm: 770\nCác field sử dụng: gender, masterCategory, subCategory, articleType, baseColour, usage, productDisplayName",
          "meaning": "Mỗi sản phẩm được biểu diễn bằng vector TF-IDF từ 7 đặc tính: giới tính, danh mục chính, danh mục phụ, loại sản phẩm, màu sắc, mục đích sử dụng, tên sản phẩm"
        },
        {
          "step": "Bước 2: Tính TF-IDF",
          "formula": "TF-IDF(t, d) = TF(t, d) * IDF(t, D)",
          "computation": "Vocabulary size: 645\nVí dụ vector sản phẩm 1: shape = (1, 645)\nCác giá trị TF-IDF khác 0 đầu tiên: [0.12684788648202416, 0.09459572818355755, 0.24357556926583507, 0.46759945087538635, 0.5842994893444177]",
          "meaning": "Vector có 645 chiều, mỗi chiều đại diện cho một từ trong vocabulary"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.6), '10861': np.float64(0.2), '10439': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.2221\n  ||u|| = 0.2434\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2221 / (0.2434 * 1.0000) = 0.9127",
          "meaning": "Similarity = 0.9127 nghĩa là sản phẩm này giống 91.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.9127\n  Product 479: similarity = 0.7453\n  Product 70: similarity = 0.6781\n  Product 278: similarity = 0.6710\n  Product 401: similarity = 0.6710",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10866': np.float64(0.6666666666666666), '10861': np.float64(0.16666666666666666), '10439': np.float64(0.16666666666666666)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2452\n  ||u|| = 0.2584\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2452 / (0.2584 * 1.0000) = 0.9486",
          "meaning": "Similarity = 0.9486 nghĩa là sản phẩm này giống 94.9% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.9486\n  Product 731: similarity = 0.6970\n  Product 341: similarity = 0.6220\n  Product 418: similarity = 0.6131\n  Product 473: similarity = 0.5909",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10065': np.float64(0.3333333333333333), '10866': np.float64(0.4444444444444444), '10861': np.float64(0.1111111111111111)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1340\n  ||u|| = 0.1665\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1340 / (0.1665 * 1.0000) = 0.8049",
          "meaning": "Similarity = 0.8049 nghĩa là sản phẩm này giống 80.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8049\n  Product 418: similarity = 0.7353\n  Product 731: similarity = 0.6525\n  Product 1: similarity = 0.6474\n  Product 718: similarity = 0.6387",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10439': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1906\n  ||u|| = 0.2347\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1906 / (0.2347 * 1.0000) = 0.8120",
          "meaning": "Similarity = 0.8120 nghĩa là sản phẩm này giống 81.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8120\n  Product 418: similarity = 0.7408\n  Product 1: similarity = 0.6636\n  Product 718: similarity = 0.6554\n  Product 731: similarity = 0.6456",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10861': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.6), '10861': np.float64(0.2), '10439': np.float64(0.2)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 1:\n  u · v_i = 0.2221\n  ||u|| = 0.2434\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2221 / (0.2434 * 1.0000) = 0.9127",
          "meaning": "Similarity = 0.9127 nghĩa là sản phẩm này giống 91.3% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 1: similarity = 0.9127\n  Product 479: similarity = 0.7453\n  Product 70: similarity = 0.6781\n  Product 278: similarity = 0.6710\n  Product 401: similarity = 0.6710",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10866': np.float64(0.6666666666666666), '10861': np.float64(0.16666666666666666), '10439': np.float64(0.16666666666666666)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.2452\n  ||u|| = 0.2584\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.2452 / (0.2584 * 1.0000) = 0.9486",
          "meaning": "Similarity = 0.9486 nghĩa là sản phẩm này giống 94.9% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.9486\n  Product 731: similarity = 0.6970\n  Product 341: similarity = 0.6220\n  Product 418: similarity = 0.6131\n  Product 473: similarity = 0.5909",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 4\nWeights: {'10065': np.float64(0.3333333333333333), '10866': np.float64(0.4444444444444444), '10861': np.float64(0.1111111111111111)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 4 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1340\n  ||u|| = 0.1665\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1340 / (0.1665 * 1.0000) = 0.8049",
          "meaning": "Similarity = 0.8049 nghĩa là sản phẩm này giống 80.5% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8049\n  Product 418: similarity = 0.7353\n  Product 731: similarity = 0.6525\n  Product 1: similarity = 0.6474\n  Product 718: similarity = 0.6387",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10439': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1906\n  ||u|| = 0.2347\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1906 / (0.2347 * 1.0000) = 0.8120",
          "meaning": "Similarity = 0.8120 nghĩa là sản phẩm này giống 81.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8120\n  Product 418: similarity = 0.7408\n  Product 1: similarity = 0.6636\n  Product 718: similarity = 0.6554\n  Product 731: similarity = 0.6456",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        },
        {
          "step": "Bước 3: Xây dựng User Profile (với interaction weights)",
          "formula": "u = (1/Σw_i) * Σ(w_i * v_i)",
          "computation": "Số sản phẩm user đã tương tác: 3\nWeights: {'10065': np.float64(0.375), '10866': np.float64(0.5), '10861': np.float64(0.125)}...\nUser profile shape: (645,)\nVí dụ user profile (5 giá trị đầu): [0.0, 0.0, 0.0, 0.0, 0.0]",
          "meaning": "User profile là trung bình có trọng số của 3 sản phẩm đã tương tác, với weight theo type: view=1.0, like=2.0, cart=3.0, purchase=4.0"
        },
        {
          "step": "Bước 4: Tính Cosine Similarity",
          "formula": "sim(u, i) = (u · v_i) / (||u|| * ||v_i||)",
          "computation": "Ví dụ với sản phẩm 0:\n  u · v_i = 0.1942\n  ||u|| = 0.2362\n  ||v_i|| = 1.0000\n  sim(u, i) = 0.1942 / (0.2362 * 1.0000) = 0.8222",
          "meaning": "Similarity = 0.8222 nghĩa là sản phẩm này giống 82.2% với sở thích của user (giá trị từ -1 đến 1, 1 = giống nhất)"
        },
        {
          "step": "Bước 5: Ranking và Recommendation",
          "formula": "Rank products by sim(u, i) descending",
          "computation": "Top 5 sản phẩm:\n  Product 0: similarity = 0.8222\n  Product 418: similarity = 0.7505\n  Product 1: similarity = 0.6508\n  Product 731: similarity = 0.6430\n  Product 718: similarity = 0.6429",
          "meaning": "Sắp xếp sản phẩm theo similarity giảm dần, chọn top-K sản phẩm có similarity cao nhất để recommend"
        }
      ],
      "cbf_matrices": {
        "tfidf_matrix": [
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12684788648202416,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10945684237870694,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10802273937743177,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.08762412121414109,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.3644387614539732,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0958778920615082,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.1306801178899534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.13046124571726606,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09261237733220674,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.18868384457697002,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.11477308257117103,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.12441395746742534,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09009132789563327,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.09518415053626149,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.14393528245910975,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ],
          [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.10739022769762342,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0
          ]
        ],
        "similarity_matrix": [
          [
            0.8221978470290819
          ],
          [
            0.7504883952006588
          ],
          [
            0.6508351729770462
          ],
          [
            0.6430406271956725
          ],
          [
            0.6429416273851217
          ],
          [
            0.5523535767199524
          ],
          [
            0.5430679569431078
          ],
          [
            0.5421089664618155
          ],
          [
            0.518318911740092
          ],
          [
            0.5135647424129608
          ],
          [
            0.5030875097547388
          ],
          [
            0.495788797018222
          ],
          [
            0.4922891994579217
          ],
          [
            0.49086363523980237
          ],
          [
            0.4853831692148929
          ],
          [
            0.4853831692148929
          ],
          [
            0.4845968744403366
          ],
          [
            0.48242265575179
          ],
          [
            0.47722103133678545
          ],
          [
            0.4756673962297847
          ]
        ]
      }
    }
  },
  "train_stats": {
    "train_size": 4,
    "test_size": 1,
    "train_ratio": 0.8,
    "train_users": 1,
    "test_users": 1,
    "train_products": 4,
    "test_products": 1
  },
  "test_pairs": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10866",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10065",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10859",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10861",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10439",
      "user_name": "Nguyen Thanh Doanh",
      "user_gender": "male",
      "user_age": 27.0
    }
  ],
  "sample_train_data": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10065",
      "interaction_type": "cart"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10866",
      "interaction_type": "purchase"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10861",
      "interaction_type": "view"
    },
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10439",
      "interaction_type": "view"
    }
  ],
  "sample_test_data": [
    {
      "user_id": "690bf0f2d0c3753df0ecbdd6",
      "product_id": "10859",
      "interaction_type": "like"
    }
  ]
}